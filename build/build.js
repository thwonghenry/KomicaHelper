!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(10)},function(t,e,n){"use strict";var r=n(5),o=function(){function t(t,e){this.method=t,this.url=e,this.xhr=new XMLHttpRequest}return t.prototype.start=function(){var t=this,e=new r.Promise(function(e,n){t.xhr.onreadystatechange=function(){var r=t.xhr.readyState;r===XMLHttpRequest.DONE&&(200===t.xhr.status||304===t.xhr.status?e(t.xhr.responseText):n())}});return this.xhr.open(this.method,this.url,!0),this.xhr.send(null),e},t}();e.Ajax=o},function(t,e,n){"use strict";function r(t,e){void 0===e&&(e=document.body),t.addEventListener("mouseover",function(){var t=this,n=this.href.match(/.*#r([0-9]*).*/);if(n&&!(n.length<2)){var r=n[1],a=function(n){function r(){o&&e.removeChild(o),o=null,this.removeAttribute("hovering"),this.removeEventListener("mouseout",r)}var o=n.cloneNode(!0);if(o.id="",/threadpost/.test(o.className)){o.className+=" reply";var i=o.children[0],s=i.children,a=s[s.length-2];"span"===a.tagName.toLowerCase()&&i.removeChild(a)}o.className+=" floatingReply";var u=t.getBoundingClientRect();o.setAttribute("style","left: "+Math.round(u.left+u.width)+"px; top: "+Math.round(u.top)+"px;"),e.appendChild(o),t.addEventListener("mouseout",r)},u=document.getElementById("r"+r);if(!u){var c=this.href.match(/.res=([0-9]*).*/);if(!c||2!==c.length)return;var l=c[1];if(i[l]&&(u=i[l].getElementById("r"+r)));else if(!s[l]){s[l]=!0,this.setAttribute("style","cursor: wait;");var f=new o.Ajax("get",this.href);f.start().then(function(e){var n=document.implementation,o=n.createHTMLDocument("Temp"),u=document.createElement("div");u.innerHTML=e,o.body.appendChild(u),i[l]=o,delete s[l],t.removeAttribute("style"),t.getAttribute("hovering")&&a(o.getElementById("r"+r))})}}u&&a(u),this.setAttribute("hovering","true")}})}var o=n(1),i={},s={};e.bindReply=r},function(t,e,n){e=t.exports=n(4)(),e.push([t.id,"#_3Maw8mdHuJ8XjVUhAyIbt8 .noDecor{text-decoration:none}#_3Maw8mdHuJ8XjVUhAyIbt8 .updateButtons{position:fixed;top:40%;right:0}#_3Maw8mdHuJ8XjVUhAyIbt8 .disabledAnchor{pointer-events:none;cursor:default;color:gray}#_3Maw8mdHuJ8XjVUhAyIbt8 .threadButtons{color:BBB;text-decoration:none;border-bottom:2px solid silver;margin-bottom:6px}#_3Maw8mdHuJ8XjVUhAyIbt8 .floatingReply{position:fixed;border:2px solid #000;box-shadow:2px 2px 2px 2px rgba(0,0,0,.9)}",""]),e.locals={komica_helper:"_3Maw8mdHuJ8XjVUhAyIbt8"}},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<e.length;o++){var s=e[o];"number"==typeof s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},function(t,e,n){var r;(function(t,o,i){/*!
	 * @overview es6-promise - a tiny implementation of Promises/A+.
	 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	 * @license   Licensed under MIT license
	 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
	 * @version   3.1.2
	 */
(function(){"use strict";function s(t){return"function"==typeof t||"object"==typeof t&&null!==t}function a(t){return"function"==typeof t}function u(t){K=t}function c(t){Q=t}function l(){return function(){t.nextTick(v)}}function f(){return function(){Y(v)}}function h(){var t=0,e=new tt(v),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function d(){var t=new MessageChannel;return t.port1.onmessage=v,function(){t.port2.postMessage(0)}}function p(){return function(){setTimeout(v,1)}}function v(){for(var t=0;G>t;t+=2){var e=rt[t],n=rt[t+1];e(n),rt[t]=void 0,rt[t+1]=void 0}G=0}function m(){try{var t=n(14);return Y=t.runOnLoop||t.runOnContext,f()}catch(e){return p()}}function y(t,e){var n=this,r=n._state;if(r===at&&!t||r===ut&&!e)return this;var o=new this.constructor(w),i=n._result;if(r){var s=arguments[r-1];Q(function(){H(r,o,s,i)})}else C(n,o,t,e);return o}function g(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(w);return S(n,t),n}function w(){}function b(){return new TypeError("You cannot resolve a promise with itself")}function _(){return new TypeError("A promises callback cannot return that same promise.")}function A(t){try{return t.then}catch(e){return ct.error=e,ct}}function x(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function j(t,e,n){Q(function(t){var r=!1,o=x(n,e,function(n){r||(r=!0,e!==n?S(t,n):k(t,n))},function(e){r||(r=!0,L(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,L(t,o))},t)}function E(t,e){e._state===at?k(t,e._result):e._state===ut?L(t,e._result):C(e,void 0,function(e){S(t,e)},function(e){L(t,e)})}function M(t,e,n){e.constructor===t.constructor&&n===ot&&constructor.resolve===it?E(t,e):n===ct?L(t,ct.error):void 0===n?k(t,e):a(n)?j(t,e,n):k(t,e)}function S(t,e){t===e?L(t,b()):s(e)?M(t,e,A(e)):k(t,e)}function T(t){t._onerror&&t._onerror(t._result),O(t)}function k(t,e){t._state===st&&(t._result=e,t._state=at,0!==t._subscribers.length&&Q(O,t))}function L(t,e){t._state===st&&(t._state=ut,t._result=e,Q(T,t))}function C(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+at]=n,o[i+ut]=r,0===i&&t._state&&Q(O,t)}function O(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,o,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?H(n,r,o,i):o(i);t._subscribers.length=0}}function I(){this.error=null}function B(t,e){try{return t(e)}catch(n){return lt.error=n,lt}}function H(t,e,n,r){var o,i,s,u,c=a(n);if(c){if(o=B(n,r),o===lt?(u=!0,i=o.error,o=null):s=!0,e===o)return void L(e,_())}else o=r,s=!0;e._state!==st||(c&&s?S(e,o):u?L(e,i):t===at?k(e,o):t===ut&&L(e,o))}function N(t,e){try{e(function(e){S(t,e)},function(e){L(t,e)})}catch(n){L(t,n)}}function q(t){return new mt(this,t).promise}function J(t){function e(t){S(o,t)}function n(t){L(o,t)}var r=this,o=new r(w);if(!z(t))return L(o,new TypeError("You must pass an array to race.")),o;for(var i=t.length,s=0;o._state===st&&i>s;s++)C(r.resolve(t[s]),void 0,e,n);return o}function P(t){var e=this,n=new e(w);return L(n,t),n}function R(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function D(t){this._id=pt++,this._state=void 0,this._result=void 0,this._subscribers=[],w!==t&&("function"!=typeof t&&R(),this instanceof D?N(this,t):U())}function X(t,e){this._instanceConstructor=t,this.promise=new t(w),Array.isArray(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&k(this.promise,this._result))):L(this.promise,this._validationError())}function V(){var t;if("undefined"!=typeof o)t=o;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;n&&"[object Promise]"===Object.prototype.toString.call(n.resolve())&&!n.cast||(t.Promise=vt)}var F;F=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var Y,K,W,z=F,G=0,Q=function(t,e){rt[G]=t,rt[G+1]=e,G+=2,2===G&&(K?K(v):W())},Z="undefined"!=typeof window?window:void 0,$=Z||{},tt=$.MutationObserver||$.WebKitMutationObserver,et="undefined"!=typeof t&&"[object process]"==={}.toString.call(t),nt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,rt=new Array(1e3);W=et?l():tt?h():nt?d():void 0===Z?m():p();var ot=y,it=g,st=void 0,at=1,ut=2,ct=new I,lt=new I,ft=q,ht=J,dt=P,pt=0,vt=D;D.all=ft,D.race=ht,D.resolve=it,D.reject=dt,D._setScheduler=u,D._setAsap=c,D._asap=Q,D.prototype={constructor:D,then:ot,"catch":function(t){return this.then(null,t)}};var mt=X;X.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},X.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===st&&t>n;n++)this._eachEntry(e[n],n)},X.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===it){var o=A(t);if(o===ot&&t._state!==st)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===vt){var i=new n(w);M(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){e(t)}),e)}else this._willSettleAt(r(t),e)},X.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===st&&(this._remaining--,t===ut?L(r,n):this._result[e]=n),0===this._remaining&&k(r,this._result)},X.prototype._willSettleAt=function(t,e){var n=this;C(t,void 0,function(t){n._settledAt(at,e,t)},function(t){n._settledAt(ut,e,t)})};var yt=V,gt={Promise:vt,polyfill:yt};n(12).amd?(r=function(){return gt}.call(e,n,e,i),!(void 0!==r&&(i.exports=r))):"undefined"!=typeof i&&i.exports?i.exports=gt:"undefined"!=typeof this&&(this.ES6Promise=gt),yt()}).call(this)}).call(e,n(8),function(){return this}(),n(13)(t))},function(t,e,n){var r=n(7);t.exports=function(t){var e=[],n=t||{};return function(t){e.push("<div"+r.attr("id",t,!0,!0)+'><a href="#" class="updateButtons noDecor">更新</a></div>')}.call(this,"komica_helper"in n?n.komica_helper:"undefined"!=typeof komica_helper?komica_helper:void 0),e.join("")}},function(t,e,n){"use strict";function r(t){return null!=t&&""!==t}function o(t){return(Array.isArray(t)?t.map(o):t&&"object"==typeof t?Object.keys(t).filter(function(e){return t[e]}):[t]).filter(r).join(" ")}function i(t){return a[t]||t}function s(t){var e=String(t).replace(u,i);return e===""+t?t:e}e.merge=function c(t,e){if(1===arguments.length){for(var n=t[0],o=1;o<t.length;o++)n=c(n,t[o]);return n}var i=t["class"],s=e["class"];(i||s)&&(i=i||[],s=s||[],Array.isArray(i)||(i=[i]),Array.isArray(s)||(s=[s]),t["class"]=i.concat(s).filter(r));for(var a in e)"class"!=a&&(t[a]=e[a]);return t},e.joinClasses=o,e.cls=function(t,n){for(var r=[],i=0;i<t.length;i++)n&&n[i]?r.push(e.escape(o([t[i]]))):r.push(o(t[i]));var s=o(r);return s.length?' class="'+s+'"':""},e.style=function(t){return t&&"object"==typeof t?Object.keys(t).map(function(e){return e+":"+t[e]}).join(";"):t},e.attr=function(t,n,r,o){return"style"===t&&(n=e.style(n)),"boolean"==typeof n||null==n?n?" "+(o?t:t+'="'+t+'"'):"":0==t.indexOf("data")&&"string"!=typeof n?(-1!==JSON.stringify(n).indexOf("&")&&console.warn("Since Jade 2.0.0, ampersands (`&`) in data attributes will be escaped to `&amp;`"),n&&"function"==typeof n.toISOString&&console.warn("Jade will eliminate the double quotes around dates in ISO form after 2.0.0")," "+t+"='"+JSON.stringify(n).replace(/'/g,"&apos;")+"'"):r?(n&&"function"==typeof n.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+t+'="'+e.escape(n)+'"'):(n&&"function"==typeof n.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+t+'="'+n+'"')},e.attrs=function(t,n){var r=[],i=Object.keys(t);if(i.length)for(var s=0;s<i.length;++s){var a=i[s],u=t[a];"class"==a?(u=o(u))&&r.push(" "+a+'="'+u+'"'):r.push(e.attr(a,u,!1,n))}return r.join("")};var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},u=/[&<>"]/g;e.escape=s,e.rethrow=function l(t,e,r,o){if(!(t instanceof Error))throw t;if(!("undefined"==typeof window&&e||o))throw t.message+=" on line "+r,t;try{o=o||n(15).readFileSync(e,"utf8")}catch(i){l(t,null,r)}var s=3,a=o.split("\n"),u=Math.max(r-s,0),c=Math.min(a.length,r+s),s=a.slice(u,c).map(function(t,e){var n=e+u+1;return(n==r?"  > ":"    ")+n+"| "+t}).join("\n");throw t.path=e,t.message=(e||"Jade")+":"+r+"\n"+s+"\n\n"+t.message,t},e.DebugItem=function(t,e){this.lineno=t,this.filename=e}},function(t,e){function n(){c=!1,s.length?u=s.concat(u):l=-1,u.length&&r()}function r(){if(!c){var t=setTimeout(n);c=!0;for(var e=u.length;e;){for(s=u,u=[];++l<e;)s&&s[l].run();l=-1,e=u.length}s=null,c=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function i(){}var s,a=t.exports={},u=[],c=!1,l=-1;a.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new o(t,e)),1!==u.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=i,a.addListener=i,a.once=i,a.off=i,a.removeListener=i,a.removeAllListeners=i,a.emit=i,a.binding=function(t){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(t){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(t,e){"use strict";function n(t){for(var e=0;e<r.length;e++){var n=r[e];if(n.match.test(t))return n}return r[0]}var r=[{match:/default/,quote:/^((?!page_num).)*#r[0-9]*/},{match:/http:\/\/.*\.mykomica.org.*/,quote:/.*#r[0-9]*/}];e.getConfigByURL=n},function(t,e,n){"use strict";function r(t,e,n){var r=document.createElement(t);r.innerHTML=e,n.appendChild(r)}var o=n(11),i=n(2),s=n(9),a=window.location.href,u=n(3),c=u[0][1],l=n(6)(u.locals),f=document.body;r("style",c,f),r("div",l,f);var h=document.getElementById(u.locals.komica_helper),d=h.children[0],p=s.getConfigByURL(a),v=/\?res=/.test(a),m=o.createUpdateCallback(a,v,document,h,p),y=0;d.addEventListener("click",function(t){var e=this;t.preventDefault(),/disabledAnchor/.test(this.className)?console.log("waiting"):(this.className+=" disabledAnchor",this.innerHTML="更新中..",y&&clearTimeout(y),m().then(function(t){var n=e.className.split(" ");return n.splice(n.length-1,1),e.className=n.join(" "),new Promise(function(n){t?(e.innerHTML="更新(+"+t+")",y=setTimeout(n,5e3)):n()})}).then(function(){e.innerHTML="更新"}))});for(var g=document.getElementsByClassName("qlink"),w=0;w<g.length;w++){var b=g[w];p.quote.test(b.href)&&i.bindReply(b,h)}},function(t,e,n){"use strict";function r(t,e,n,r,s){function a(t){f.innerHTML=t,h=l.getElementById("threads"),d=n.getElementById("threads"),p=h.children,v=d.children}void 0===r&&(r=document.body);var u=new o.Ajax("get",t),c=n.implementation,l=c.createHTMLDocument("Temp"),f=n.createElement("div");l.body.appendChild(f);var h,d,p,v;return e?function(){return u.start().then(function(t){a(t);for(var e=p.length-v.length,o=v[v.length-2],u=p.length-2,c=0;u>=0&&o.id!==p[u].id;u--,c++){d.insertBefore(p[u],v[v.length-1-c]);var l=n.querySelectorAll(p[u].id+" .qlink");if(l)for(var f=0;f<l.length;f++){var h=l[f];s.quote.test(h.href)&&i.bindReply(h,r)}}return new Promise(function(t){t(e)})},function(){return console.log("rejected")})}:function(){return u.start().then(function(t){a(t),d.innerHTML=h.innerHTML;for(var e=document.getElementsByClassName("qlink"),n=0;n<e.length;n++){var o=e[n];s.quote.test(o.href)&&i.bindReply(o,r)}return new Promise(function(t){t(0)})},function(){return console.log("rejected")})}}var o=n(1),i=n(2);e.createUpdateCallback=r},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e){},function(t,e){}]);